<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Playfair Cipher Interactive</title>
<style>
    body {
        font-family: Arial, sans-serif;
        background-color: #f5f5f5;
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: 100vh;
    }
    .container {
        background-color: white;
        padding: 20px 30px;
        border-radius: 10px;
        box-shadow: 0 0 15px rgba(0,0,0,0.2);
        width: 450px;
    }
    h1 { text-align: center; margin-bottom: 20px; }
    label { display: block; margin-top: 10px; }
    input, textarea { width: 100%; padding: 8px; margin-top: 5px; border-radius: 5px; border: 1px solid #ccc; box-sizing: border-box; }
    textarea { resize: none; height: 80px; }
    .buttons { display: flex; justify-content: space-between; margin-top: 15px; flex-wrap: wrap; gap:5px; }
    button { padding: 10px 15px; border: none; background-color: #007bff; color: white; border-radius: 5px; cursor: pointer; flex:1; }
    button:hover { background-color: #0056b3; }
    #matrixOutput { margin-top:10px; white-space: pre; font-family: monospace; background-color: #eee; padding:10px; border-radius:5px;}
    #preparedTextOutput { margin-top:10px; background-color: #eee; padding:10px; border-radius:5px;}
</style>
</head>
<body>
<div class="container">
    <h1>Playfair Cipher</h1>

    <label>Keyword</label>
    <input type="text" id="keyword" placeholder="Enter keyword">

    <label>Input Text</label>
    <textarea id="inputText" placeholder="Enter text here"></textarea>

    <div class="buttons">
        <button onclick="encryptPlayfair()">Encrypt</button>
        <button onclick="decryptPlayfair()">Decrypt</button>
        <button onclick="showMatrix()">Show 5x5 Matrix</button>
        <button onclick="showPreparedText()">Show Prepared Text</button>
    </div>

    <label>Output Text</label>
    <textarea id="outputText" readonly></textarea>

    <div id="matrixOutput"></div>
    <div id="preparedTextOutput"></div>
</div>

<script>
function createMatrix(keyword) {
    keyword = keyword.toUpperCase().replace(/J/g, "I");
    let matrix = [];
    let used = {};

    for (let i = 0; i < keyword.length; i++) {
        let ch = keyword[i];
        if (ch >= 'A' && ch <= 'Z' && !used[ch]) {
            matrix.push(ch);
            used[ch] = true;
        }
    }

    for (let i = 65; i <= 90; i++) {
        let ch = String.fromCharCode(i);
        if (ch === 'J') continue;
        if (!used[ch]) {
            matrix.push(ch);
            used[ch] = true;
        }
    }

    let grid = [];
    for (let i = 0; i < 5; i++) {
        grid.push(matrix.slice(i*5, i*5+5));
    }

    return grid;
}

function findPosition(matrix, letter) {
    for (let row=0; row<5; row++) {
        for (let col=0; col<5; col++) {
            if (matrix[row][col] === letter) return [row, col];
        }
    }
    return null;
}

function prepareText(text) {
    text = text.toUpperCase().replace(/J/g,"I").replace(/[^A-Z]/g,"");
    let result = "";
    for (let i=0; i<text.length; i++) {
        let a = text[i];
        let b = text[i+1] || 'X';
        if (a===b) {
            result += a + 'X';
        } else {
            result += a;
            if (i+1 < text.length) {
                result += b;
                i++;
            }
        }
    }
    if (result.length % 2 !==0) result += 'X';
    return result;
}

// --- ENCRYPT ---
function encryptPlayfair() {
    let keyword = document.getElementById("keyword").value;
    let text = document.getElementById("inputText").value;
    if (!keyword || !text) { alert("Enter keyword and text"); return; }

    let matrix = createMatrix(keyword);
    let prepared = prepareText(text);
    let cipher = "";

    for (let i=0; i<prepared.length; i+=2) {
        let a = prepared[i], b = prepared[i+1];
        let [row1,col1] = findPosition(matrix,a);
        let [row2,col2] = findPosition(matrix,b);

        if (row1===row2) {
            cipher += matrix[row1][(col1+1)%5] + matrix[row2][(col2+1)%5];
        } else if (col1===col2) {
            cipher += matrix[(row1+1)%5][col1] + matrix[(row2+1)%5][col2];
        } else {
            cipher += matrix[row1][col2] + matrix[row2][col1];
        }
    }

    document.getElementById("outputText").value = cipher;
}

// --- DECRYPT ---
function decryptPlayfair() {
    let keyword = document.getElementById("keyword").value;
    let text = document.getElementById("inputText").value;
    if (!keyword || !text) { alert("Enter keyword and text"); return; }

    let matrix = createMatrix(keyword);
    let prepared = text.toUpperCase().replace(/J/g,"I").replace(/[^A-Z]/g,"");
    let plain = "";

    for (let i=0; i<prepared.length; i+=2) {
        let a = prepared[i], b = prepared[i+1];
        let [row1,col1] = findPosition(matrix,a);
        let [row2,col2] = findPosition(matrix,b);

        if (row1===row2) {
            plain += matrix[row1][(col1+4)%5] + matrix[row2][(col2+4)%5];
        } else if (col1===col2) {
            plain += matrix[(row1+4)%5][col1] + matrix[(row2+4)%5][col2];
        } else {
            plain += matrix[row1][col2] + matrix[row2][col1];
        }
    }

    document.getElementById("outputText").value = plain;
}

// --- SHOW 5x5 MATRIX ---
function showMatrix() {
    let keyword = document.getElementById("keyword").value;
    if (!keyword) { alert("Enter keyword"); return; }
    let matrix = createMatrix(keyword);
    let text = "";
    for (let i=0;i<5;i++) text += matrix[i].join(" ") + "\n";
    document.getElementById("matrixOutput").textContent = "5x5 Matrix:\n" + text;
}

// --- SHOW PREPARED TEXT ---
function showPreparedText() {
    let text = document.getElementById("inputText").value;
    if (!text) { alert("Enter text"); return; }
    let prepared = prepareText(text);
    document.getElementById("preparedTextOutput").textContent = "Prepared Text:\n" + prepared;
}
</script>
</body>
</html>
